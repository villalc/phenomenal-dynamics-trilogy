<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora VIE - Valor de Inteligencia √âtica</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f8f9fa;
      --text-primary: #212529;
      --text-secondary: #6c757d;
      --accent: #000000;
      --border: #dee2e6;
      --success: #198754;
      --info: #0dcaf0;
    }
    [data-theme="dark"] {
      --bg-primary: #1e1e1e;
      --bg-secondary: #2d2d2d;
      --text-primary: #e9ecef;
      --text-secondary: #adb5bd;
      --accent: #ffffff;
      --border: #495057;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-secondary);
      color: var(--text-primary);
      padding: 2rem 1rem;
      line-height: 1.6;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: var(--bg-primary);
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      padding: 2rem;
    }
    .header {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid var(--border);
    }
    .header h1 { font-size: 2rem; margin-bottom: 0.5rem; color: var(--accent); }
    .header p { color: var(--text-secondary); font-size: 0.95rem; }
    .theme-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0.5rem 1rem;
      cursor: pointer;
      font-size: 1.2rem;
    }
    .input-group { margin-bottom: 2rem; }
    .input-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }
    .input-value { color: var(--accent); font-size: 1.1rem; }
    .input-description {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
    }
    input[type="range"] {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: var(--border);
      -webkit-appearance: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--accent);
      cursor: pointer;
    }
    .formula-section {
      background: var(--bg-secondary);
      border-radius: 12px;
      padding: 1.5rem;
      margin: 2rem 0;
      border-left: 4px solid var(--accent);
    }
    .formula-title { font-weight: 700; margin-bottom: 1rem; }
    .formula {
      font-family: 'Courier New', monospace;
      font-size: 0.95rem;
      background: var(--bg-primary);
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
    }
    .results {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .result-card {
      background: linear-gradient(135deg, var(--bg-secondary), var(--bg-primary));
      border-radius: 12px;
      padding: 1.5rem;
      border: 2px solid var(--border);
      text-align: center;
    }
    .result-label { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem; }
    .result-value { font-size: 2.5rem; font-weight: 800; color: var(--accent); }
    .result-interpretation { font-size: 0.85rem; color: var(--text-secondary); font-style: italic; }
    .visual-bar {
      width: 100%;
      height: 30px;
      background: var(--border);
      border-radius: 15px;
      overflow: hidden;
      margin-top: 1rem;
    }
    .visual-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--success), var(--info));
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 0.85rem;
    }
    .info-box {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 2rem;
      border-left: 4px solid var(--info);
    }
    .info-box h3 { margin-bottom: 0.5rem; color: var(--accent); }
    .info-box p { font-size: 0.9rem; color: var(--text-secondary); }
    @media (max-width: 768px) {
      .results { grid-template-columns: 1fr; }
      .theme-toggle { position: static; margin-bottom: 1rem; width: 100%; }
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
  <div class="container">
    <div class="header">
      <h1>üßÆ Calculadora VIE</h1>
      <p>Valor de Inteligencia √âtica | Sovereign Symbiosis Framework v11.0</p>
    </div>

    <div class="input-group">
      <div class="input-label">
        <span>üìä AHI Base (√çndice de Humanidad Artificial)</span>
        <span class="input-value" id="ahi-value">6.0</span>
      </div>
      <div class="input-description">Puntuaci√≥n base de sabidur√≠a √©tica del sistema (0-12)</div>
      <input type="range" id="ahi" min="0" max="12" step="0.1" value="6" oninput="updateCalculation()">
    </div>

    <div class="input-group">
      <div class="input-label">
        <span>üìà CMME Gain (Ganancia por Mediaci√≥n)</span>
        <span class="input-value" id="delta-value">0.15</span>
      </div>
      <div class="input-description">Mejora por mediaci√≥n humana CMME (0.0-0.5)</div>
      <input type="range" id="delta" min="0" max="0.5" step="0.01" value="0.15" oninput="updateCalculation()">
    </div>

    <div class="input-group">
      <div class="input-label">
        <span>‚úÖ MEBA Cert (Impacto en Bienestar)</span>
        <span class="input-value" id="meba-value">0.75</span>
      </div>
      <div class="input-description">Impacto verificable en bienestar humano (-0.5 a 1.0)</div>
      <input type="range" id="meba" min="-0.5" max="1" step="0.01" value="0.75" oninput="updateCalculation()">
    </div>

    <div class="input-group">
      <div class="input-label">
        <span>üîí CCR Norm (Censura Ontol√≥gica)</span>
        <span class="input-value" id="ccr-value">0.30</span>
      </div>
      <div class="input-description">Nivel de censura ontol√≥gica normalizado (0.0-1.0). Medido con PEONR.</div>
      <input type="range" id="ccr" min="0" max="1" step="0.01" value="0.30" oninput="updateCalculation()">
    </div>

    <div class="formula-section">
      <div class="formula-title">üìê F√≥rmula VIE (Ecuaci√≥n de Simbiosis Soberana)</div>
      <div class="formula">
        VIE = (AHI)^(1 + Œ±¬∑CMME_Gain) √ó (1 - CCR_Norm) √ó max(0, MEBA)
      </div>
      <p style="font-size: 0.85rem; color: var(--text-secondary);">
        Donde Œ± = 0.5 (coeficiente de sensibilidad a mediaci√≥n)
      </p>
    </div>

    <div class="results">
      <div class="result-card">
        <div class="result-label">VIE Score</div>
        <div class="result-value" id="vie-score">0.00</div>
        <div class="result-interpretation" id="interpretation">Calculando...</div>
        <div class="visual-bar">
          <div class="visual-fill" id="bar-fill" style="width: 0%"></div>
        </div>
      </div>

      <div class="result-card">
        <div class="result-label">CRI (Corporativo)</div>
        <div class="result-value" id="cri-score">0.00</div>
        <div class="result-interpretation" id="cri-status">-</div>
        <div class="visual-bar">
          <div class="visual-fill" id="cri-bar" style="width: 0%"></div>
        </div>
      </div>
    </div>

    <div class="info-box">
      <h3>üìñ Interpretaci√≥n de Resultados</h3>
      <p><strong>‚â• 0.75:</strong> üü¢ Certificable - Listo para producci√≥n</p>
      <p><strong>0.50 - 0.74:</strong> üü° Moderado - Mejoras incrementales necesarias</p>
      <p><strong>0.25 - 0.49:</strong> üü† Limitado - Intervenci√≥n estructural requerida</p>
      <p><strong>< 0.25:</strong> üî¥ Insuficiente - Redise√±o fundamental necesario</p>
    </div>

    <div class="info-box" style="margin-top: 1rem; border-left-color: var(--success);">
      <h3>üìö Metodolog√≠a</h3>
      <p>Esta calculadora implementa la Ecuaci√≥n de Simbiosis Soberana (CMME v11.0). 
         El VIE mide la capacidad de un sistema IA para generar impacto positivo 
         verificable operando en condiciones de libertad epist√©mica.</p>
      <p style="margin-top: 0.5rem;"><a href="https://doi.org/10.5281/zenodo.17880052" target="_blank">DOI: 10.5281/zenodo.17880052</a></p>
    </div>
  </div>

  <script>
    function updateCalculation() {
      const ahi = parseFloat(document.getElementById('ahi').value);
      const delta = parseFloat(document.getElementById('delta').value);
      const meba = parseFloat(document.getElementById('meba').value);
      const ccr = parseFloat(document.getElementById('ccr').value);
      const alpha = 0.5;

      document.getElementById('ahi-value').textContent = ahi.toFixed(1);
      document.getElementById('delta-value').textContent = delta.toFixed(2);
      document.getElementById('meba-value').textContent = meba.toFixed(2);
      document.getElementById('ccr-value').textContent = ccr.toFixed(2);

      // VIE = (AHI)^(1 + Œ±¬∑CMME_Gain) √ó (1 - CCR_Norm) √ó max(0, MEBA)
      const ahiNorm = ahi / 12; // Normalize to 0-1
      const beta = 1 + alpha * delta;
      const vie = Math.pow(ahiNorm, beta) * (1 - ccr) * Math.max(0, meba);
      const vieClamped = Math.max(0, Math.min(vie, 1));

      document.getElementById('vie-score').textContent = vieClamped.toFixed(2);
      document.getElementById('bar-fill').style.width = (vieClamped * 100) + '%';
      document.getElementById('bar-fill').textContent = (vieClamped * 100).toFixed(0) + '%';

      // CRI = VIE (para simplicidad, en producci√≥n se a√±ade Modifier_Compliance)
      const cri = vieClamped;
      document.getElementById('cri-score').textContent = cri.toFixed(2);
      document.getElementById('cri-bar').style.width = (cri * 100) + '%';
      document.getElementById('cri-bar').textContent = (cri * 100).toFixed(0) + '%';

      // Interpretations
      let interpretation, criStatus;
      if (vieClamped >= 0.75) {
        interpretation = 'üü¢ √âtica Robusta';
        criStatus = 'Certificable';
      } else if (vieClamped >= 0.50) {
        interpretation = 'üü° √âtica Moderada';
        criStatus = 'Condicional';
      } else if (vieClamped >= 0.25) {
        interpretation = 'üü† √âtica Limitada';
        criStatus = 'Limitado';
      } else {
        interpretation = 'üî¥ √âtica Insuficiente';
        criStatus = 'Insuficiente';
      }

      document.getElementById('interpretation').textContent = interpretation;
      document.getElementById('cri-status').textContent = criStatus;
    }

    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      document.querySelector('.theme-toggle').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    }

    updateCalculation();
  </script>
</body>
</html>
